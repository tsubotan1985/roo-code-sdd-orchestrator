# Rule: 高精度実装計画生成ガイドライン

## 1. 概要
このルールは、サンプルレベルの精度を持つ実装計画（tasks.md）を生成するための詳細なガイドラインを定義します。

## 2. 実装計画の構造

### 2.1 基本フォーマット
```markdown
# 実装計画

- [ ] 1. [メイン機能名（日本語）]
  - [具体的なクラス・メソッド実装（日本語）]
  - [テスト作成（日本語）]
  - [ドキュメント更新（日本語）]
  - _要件: [要件ID]_

- [ ] 2. [次のメイン機能名（日本語）]
  - [詳細なサブタスク1（日本語）]
  - [詳細なサブタスク2（日本語）]
  - [統合・検証作業（日本語）]
  - _要件: [要件ID]_
```

### 2.2 タスク階層の定義
- **レベル1**: メイン機能単位（例: "1. コア円形回帰コンポーネントの作成"）
- **レベル2**: 具体的な実装単位（例: "AngleEncoderクラスのsin/cos変換メソッドを実装"）
- **要件参照**: 各メインタスクの末尾に必須

## 3. タスク記述の品質基準

### 3.1 具体性の要件
- **クラス名**: 実装するクラス名を明記（例: `AngleEncoder`, `CircularRegressor`）
- **メソッド名**: 主要なメソッド名を明記（例: `fit()`, `predict()`, `encode()`）
- **技術詳細**: 使用するアルゴリズムや技術を明記（例: "atan2-based angle reconstruction"）

### 3.2 包括性の要件
各メイン機能について以下を必ず含める：
- **コア実装**: 主要なクラス・メソッドの実装
- **テスト作成**: 単体テスト、統合テスト、パフォーマンステスト
- **エラーハンドリング**: 例外処理と入力検証
- **ドキュメント**: API仕様、ユーザーガイド、トラブルシューティング
- **統合作業**: 既存システムとの統合
- **検証・監視**: パフォーマンス監視、ログ記録

### 3.3 日本語化の要件
- **タスクタイトル**: 完全に日本語で記述
- **サブタスク**: 完全に日本語で記述
- **技術用語**: 適切な日本語技術用語を使用
- **要件参照**: `_要件: X.X, Y.Y_` 形式で日本語ラベル

## 4. サンプルレベル実装計画の例

```markdown
# 実装計画

- [ ] 1. コア円形回帰コンポーネントの作成
  - AngleEncoderクラスのsin/cos変換メソッドを実装
  - AngleDecoderクラスのatan2ベース角度再構築を実装
  - エンコード/デコード機能の包括的な単体テストを作成
  - _要件: 1.4, 1.5, 6.1_

- [ ] 2. CircularRegressorクラスの実装
  - sklearn互換インターフェースを持つCircularRegressorクラスを作成
  - 4コンポーネントモデル訓練のfit()メソッドを実装
  - 角度再構築のpredict()メソッドを実装
  - パラメータ管理メソッド（get_params, set_params）を追加
  - _要件: 1.1, 2.1, 6.2_

- [ ] 3. モデル設定管理システムの作成
  - モデルタイプ選択のRegressionConfigManagerを実装
  - 設定検証とデフォルトパラメータ処理を追加
  - 円形回帰vs標準回帰の設定スキーマを作成
  - _要件: 4.1, 4.2, 4.3, 4.4_
```

## 5. 品質チェックポイント

実装計画作成時に以下を必ず確認：

### 5.1 構造チェック
- [ ] メインタスクが機能単位で適切に分割されているか
- [ ] サブタスクが具体的な実装単位になっているか
- [ ] 階層構造が2レベルで適切に整理されているか

### 5.2 内容チェック
- [ ] 各タスクに具体的なクラス名・メソッド名が含まれているか
- [ ] 技術的詳細（アルゴリズム、技術）が明記されているか
- [ ] テスト・ドキュメント・エラーハンドリングが含まれているか

### 5.3 トレーサビリティチェック
- [ ] 全メインタスクに要件IDが記載されているか
- [ ] 要件IDが正確で漏れがないか
- [ ] 要件との対応関係が論理的に正しいか

### 5.4 日本語化チェック
- [ ] タスクタイトルが完全に日本語で記述されているか
- [ ] サブタスクが完全に日本語で記述されているか
- [ ] 技術用語が適切な日本語で表現されているか

### 5.5 順序性チェック
- [ ] 依存関係を考慮した論理的な順序になっているか
- [ ] 基盤コンポーネントから上位レイヤーへの順序か
- [ ] テストとドキュメントが適切なタイミングに配置されているか

## 6. 実装計画生成プロセス

### 6.1 準備フェーズ
1. `requirements.md`から全要件を抽出
2. `design.md`から主要コンポーネントとアーキテクチャを理解
3. 依存関係マップを作成

### 6.2 構造化フェーズ
1. 機能単位でメインタスクを特定
2. 各メインタスクを具体的なサブタスクに分解
3. 要件トレーサビリティマップを作成

### 6.3 詳細化フェーズ
1. 各サブタスクに具体的なクラス名・メソッド名を追加
2. 技術的詳細とアルゴリズムを明記
3. テスト・ドキュメント・統合作業を追加

### 6.4 検証フェーズ
1. 品質チェックポイントに基づく検証
2. 要件カバレッジの確認
3. 日本語化の最終確認

## 7. エラー回避のベストプラクティス

### 7.1 よくある問題と対策
- **問題**: タスクが抽象的すぎる
- **対策**: 具体的なクラス名・メソッド名を必ず含める

- **問題**: 要件トレーサビリティの欠如
- **対策**: 各メインタスクに必ず要件IDを記載

- **問題**: テスト・ドキュメントの漏れ
- **対策**: 包括性チェックリストを使用

### 7.2 品質向上のコツ
- 実装者の視点で具体性を確保
- 単一コミットで完了可能な粒度に調整
- 依存関係を明確に意識した順序付け
- 日本語の自然さと技術的正確性のバランス
# Rule: Requirements Definition Phase (Enhanced v2)

## 1. Objective
このフェーズの目標は、機能要件と非機能要件を網羅した、明確で検証可能な`requirements.md`を作成することです。特に、実装計画での要件トレーサビリティを確保するため、体系的な要件ID管理を実装します。

## 2. Requirements ID Management System

### 2.1 要件ID体系
- **機能要件**: `1.1`, `1.2`, `1.3`, ... (1.x系)
- **パフォーマンス要件**: `2.1`, `2.2`, `2.3`, ... (2.x系)
- **セキュリティ要件**: `3.1`, `3.2`, `3.3`, ... (3.x系)
- **信頼性要件**: `4.1`, `4.2`, `4.3`, ... (4.x系)
- **保守性要件**: `5.1`, `5.2`, `5.3`, ... (5.x系)
- **ユーザビリティ要件**: `6.1`, `6.2`, `6.3`, ... (6.x系)
- **その他要件**: `7.1`, `7.2`, `7.3`, ... (7.x系)

### 2.2 要件記述フォーマット
```markdown
### 1.1 [要件タイトル]
**ユーザーストーリー**: [As a... I want... So that...]
**受け入れ基準**:
- WHEN [条件] THEN [システム] SHALL [動作]
- WHEN [条件] THEN [システム] SHALL [動作]
```

## 3. Process

### 3.1 Project Charter
まず、機能の「はじめに」セクションを作成します。これには、機能の概要、目的、ターゲットユーザー、関連する専門用語の定義を含めます。

### 3.2 Functional Requirements (1.x系)
ユーザーストーリーと受け入れ基準（EARS形式: `WHEN...THEN...SHALL`）を用いて、機能要件を定義します。各要件に`1.1`, `1.2`などの連番IDを付与します。

### 3.3 Non-Functional Requirements
以下のNFRsについて体系的にヒアリングを行います。各カテゴリに対応するID系統を使用します：

#### 3.3.1 パフォーマンス要件 (2.x系)
応答時間、スループット、データ処理量など。
例: `2.1` 数百MBのファイルを5分以内に処理できること

#### 3.3.2 セキュリティ要件 (3.x系)
認証、認可、データ保護、入力検証など。

#### 3.3.3 信頼性/可用性要件 (4.x系)
エラーハンドリング、ログ記録、稼働率など。

#### 3.3.4 保守性/運用性要件 (5.x系)
設定管理、国際化（i18n：英語ベース、必要最小限の部分のみ日本語とフランス語に翻訳）、ドキュメントなど。

#### 3.3.5 ユーザビリティ要件 (6.x系)
UIの応答性、アクセシビリティなど。

#### 3.3.6 その他要件 (7.x系)
上記カテゴリに該当しない特殊要件。

### 3.4 要件トレーサビリティマトリックス作成
全要件を一覧化し、後の実装計画で参照しやすい形式で整理します。

### 3.5 Finalization
全ての要件を`requirements.md`にまとめ、要件IDが適切に付与されていることを確認し、ユーザーに最終承認を求めます。

## 4. Quality Assurance

### 4.1 要件品質チェック
- [ ] 各要件に適切なIDが付与されているか
- [ ] ユーザーストーリー形式で記述されているか
- [ ] 受け入れ基準がEARS形式で記述されているか
- [ ] 要件が検証可能で具体的か

### 4.2 トレーサビリティ準備
- [ ] 要件IDが体系的に管理されているか
- [ ] 実装計画での参照に適した形式か
- [ ] 要件間の依存関係が明確か
